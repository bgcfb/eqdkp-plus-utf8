<!DOCTYPE html>
<html>
<head>
<!--
/*	Project:	EQdkp-Plus
 *	Package:	EQdkp-plus
 *	Link:		http://eqdkp-plus.eu
 *
 *	Copyright (C) 2006-2015 EQdkp-Plus Developer Team
 *
 *	This program is free software: you can redistribute it and/or modify
 *	it under the terms of the GNU Affero General Public License as published
 *	by the Free Software Foundation, either version 3 of the License, or
 *	(at your option) any later version.
 *
 *	This program is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *	GNU Affero General Public License for more details.
 *
 *	You should have received a copy of the GNU Affero General Public License
 *	along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
 --> 


	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>My Guild - News</title>

	<link rel="stylesheet" href="_css/combined.css">

	<script src="_js/combined.js"></script>
	<script src="_js/lang.js"></script>
	
	<!-- For iPhone 4 with high-resolution Retina display: -->
	<link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-114x114.png">
	<!-- For first-generation iPad: -->
	<link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-72x72.png">
	<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
	<link rel="apple-touch-icon" href="apple-touch-icon.png">
</head>
<body>
<script id="panel-init">
	$(function() {
		$( "body>[data-role='panel']" ).panel();
		$("body>[data-role='panel']").trigger("create");
		$("body>[data-role='panel']").trigger( "updatelayout" );
		$("#login_submit").button();
		
		$(document).delegate("#eq-login-panel", "panelopen", function(event, ui){
			$("#eqdkp_username").focus();
			$("#eq-login-panel .message").hide();
		});
		
		$(document).delegate("#eq-navmenu-panel", "panelbeforeopen", function(event, ui){
			var recent_page = $.mobile.activePage.attr('id');
			$(".eq-navmenu-panel .eq-panelnav li").removeClass('active');
			$("#eq-navmenu-panel").find("a[href=#"+recent_page+"]").parent().addClass('active');
		});
	});
</script>

<script type="text/javascript">
	var sid = ReadCookie('eqdkpm_sid');
	if (sid == ''){
		sid = 'eqdkpm';
	}
	var news = false;
	var raids = false;
	var roles = new Array();
	var points = new Array();
	var eventid = 0;
	var common_infos = false;
	var cron_news = false;
	var cron_shouts = false;
	var cron_raids = false;
	var cron_points = false;
	var cron_forum = false;
	var refresh_news = false;
	var refresh_shouts = false;
	var refresh_raids = false;
	var refresh_points = false;
	var refresh_forum = false;
	var common_infos_loaded = false;
	var loadinginfo_news = false;
	var loadinginfo_shouts = false;
	var loadinginfo_raids = false;
	var loadinginfo_points = false;
	var loadinginfo_forum = false;
	var loc = new Array();
	var lang_loaded = false;
	var intDefaultRaidgroup = 0;
		
	$( document ).delegate("#main", "pagecreate", function() {
		load_news();
	});	
	$( document ).delegate("#raids", "pagecreate", function() {
		load_raids();
	});
	$( document ).delegate("#shout", "pagecreate", function() {
		load_shouts();
	});
	$( document ).delegate("#points", "pagecreate", function() {
		load_points();
	});
	$( document ).delegate("#forum", "pagecreate", function() {
		load_forum();
	});
	
	load_lang();
	
	$( document ).delegate("#main, #raids, #shout, #forum, #points, #login, #show_raid, #show_news", "pagecreate", function() {
		is_loggedin();
		if (!common_infos_loaded){load_common_infos(); common_infos_loaded = true;}
	});
	
	
	//Reset Messages
	$( document ).delegate("#main, #raids, #shout, #forum, #points, #login, #show_raid, #show_news", "pagebeforeshow", function() {
		if (!lang_loaded) {load_lang(); lang_loaded = true;}
		hideMessage();
	});
		
	$( document ).delegate("#main" , "pageshow", function() {
		if (refresh_news) { load_news(); refresh_news = false;}
		if (!loadinginfo_news) { $.mobile.loading( 'show'); loadinginfo_news = true;}
		if (common_infos) {document.title = common_infos.eqdkp.name + ' - News';}
	});
	
	$( document ).delegate("#raids" , "pageshow", function() {
		if (refresh_raids) { load_raids(); refresh_raids = false;}
		if (!loadinginfo_raids) { $.mobile.loading( 'show'); loadinginfo_raids = true;}
	});
	
	$( document ).delegate("#shout" , "pageshow", function() {
		load_shouts();
		if (!loadinginfo_shouts) { $.mobile.loading( 'show'); loadinginfo_shouts = true;}
	});
	
	$( document ).delegate("#forum" , "pageshow", function() {
		load_forum();
	});
	
	$( document ).delegate("#points" , "pageshow", function() {
		if (refresh_points) { load_points(); refresh_points = false;}
		if (!loadinginfo_points) { $.mobile.loading( 'show'); loadinginfo_points = true;}
	});
	
	$( document ).delegate('#show_news, #show_raid' , "swiperight", function(event) {
		window.history.back();
        event.preventDefault();
	});
	
	
	function load_lang(){

		var browser_lang = detect_browser_lang();
		if (supported_langs[browser_lang] != undefined){
			var loc_code = supported_langs[browser_lang];
		} else {
			var loc_code = supported_langs['en-EN'];
		}
		loc = l[loc_code];
		
		//Login-Page
		$('.loc_username').html(loc['username']);
		$('.loc_password').html(loc['password']);
		$('.loc_remember').html(loc['remember']);
		$('#login_submit').val(loc['login']);
		$('.loc_uareloggedin').html(loc['loc_uareloggedin']);
		//Common
		$('.loc_fulllink').html(loc['backtofullversion']);
		$('.loc_points').html(loc['menu_points']);
		$('.loc_forum').html(loc['menu_forum']);
		$('.loc_raids').html(loc['menu_raids']);
		$('.loc_shouts').html(loc['menu_shouts']);
		$('.loc_news').html(loc['menu_news']);
		$('.login_button').html(loc['login']);
		$('.logout_button').html(loc['logout']);
		$('.loc_back').html(loc['back']);
		//Show Raid
		$('.loc_note').html(loc['note']);
		$('.loc_select_status').html(loc['select_status']);
		$('.loc_select_role').html(loc['select_role']);
		$('.loc_select_char').html(loc['select_char']);
		$('.loc_raid_signup').html(loc['raid_signup']);
		$('#signup_button').html(loc['signup']);
		$('.loc_login').html(loc['login']);
		$('.loc_showraid').html(loc['showraid']);
		$('.loc_raidgroup').html(loc['raidgroup']);
		//Shouts
		$('#shoutButton').val(loc['shout']);
		
	}
	
	function load_common_infos(){
		$.ajax({
			   type: "GET",
			   url: "../api.php?function=data&format=json&s="+sid,
			   success: function(msg){
					var obj = msg;
					if (obj.status == '1'){
						common_infos = obj;
						$('.guildname').html(obj.eqdkp.name);
						document.title = obj.eqdkp.name + ' - News';
					}
			   },
			   error: function (a,b,c){
					showMessage(loc['load_error']+' load_common_infos()');
			   }
			 });
	}
	
	function load_news(id){		
		$.ajax({
			   type: "GET",
			   url: "../api.php?function=latest_articles&number=10&format=json&s="+sid,
			   success: function(msg){					
					var obj = msg;
					if (obj.status == '1'){
						//Start Cron
						window.clearInterval(cron_news);
						cron_news = window.setInterval(load_news, 1000 * 60 * 10); //10 Min	
					
						news = obj.entries;
						var output = '<ul data-role="listview" data-inset=\'true\'>';
						if (obj.entries != null){
							$.each(obj.entries, function(key, value) {
								output = output + "<li><a href='javascript:show_news("+value.id+");'><h3>"+value.title+"</h3><p>"+format_date(value.date)+", "+value.author+"</p><span class='ui-li-count'>"+value.comments.count+" <i class='fa fa-comment'></i></span></a></li>";
							});
						} else {
							output = output + '<li>'+loc['no_news']+'</li>';
						}
						output = output + "</ul>";
						$('#content_news').html(output).trigger('create');
						
						if (id){
							show_news(id);
						}
					} else {
						//Clear Cron
						window.clearInterval(cron_news);
						$('#content_news').html('').trigger('create');
						if (obj.error == 'access denied'){
							soft_login();				
						} else {						
							showMessage(loc['load_error']+' load_news()');
						}
						
					}
					$.mobile.loading( 'hide');
					loadinginfo_news = true;
			   },
			   error: function (a,b,c){
					showMessage(loc['load_error']+' load_news()');
			   }
			 });
	}
	
	function show_news(id){
		$.mobile.changePage('#show_news');
		$.mobile.loading( 'show');
		var output = "";
		if (!id) {$.mobile.changePage('#main');}
		
		if (news != false){
			$.each(news, function(key, value) {
				if (value.id == id){
					output = output + "<h1>" + value.title + '</h1><p>' + value.text + "</p>";
					var comments = '<div data-role="collapsible" data-collapsed="false"><h3><i class="fa fa-comment"></i> '+loc['comments']+'</h3>';
					
					if (value.comments.count > 0){
						comments = comments + '<div class="comments">';
						$.each(value.comments.comments, function(ckey, cvalue) {
							comments = comments + '<div class="comment-container"><div class="comment-avatar"><img src="'+cvalue.user_avatar+'" /></div><div class="comment-message"><h3>' + cvalue.username + ', '+format_date(cvalue.date) + '</h3><p>' + cvalue.message + '</p></div></div>';
						});
						comments = comments + '</div>';
						
					}
					
					if (is_loggedin()){
						comments = comments + '<div><label for="news_comment" class="loc_comment">'+loc['write_comment']+'</label><textarea id="news_comment" name="news_comment"></textarea></div><button name="news_comment" data-icon="check" data-theme="b" onclick="add_news_comment('+id+');" id="news_comment_button" class="comment_button">'+loc['comment_button']+'</button></div>';
					}
					
					comments = comments + '</div>';
					output = output + comments;
					$('#content_show_news').show().html(output).trigger('create');
					$('#news_comment_button').button();
					$.mobile.loading( 'hide');
					return false;
				}
			});
			
		}
	}
	
	function add_news_comment(id){
		var page = 'articles';
		var attachid = id;
		var comment = $("#news_comment").val();
		$('#news_comment_button').button().button('disable');
		
		add_comment(page, attachid, comment, 'news', id);
	}
	
	function add_raid_comment(id){
		var page = 'viewcalraid';
		var attachid = id;
		var comment = $("#raid_comment").val();
		$('#raid_comment_button').button().button('disable');
		
		add_comment(page, attachid, comment, 'raid', id);
	}
	
	function load_raids(){
		var icalfeed = false;
		$.ajax({
			   type: "GET",
			   url: "../api.php?function=calevents_list&number=10&format=json&s="+sid,
			   success: function(msg){
					
					var obj = msg;
					if (obj.status == '1'){
						//Start Cron
						window.clearInterval(cron_raids);
						cron_raids = window.setInterval(load_raids, 1000 * 60 * 5); //5 Min
						
						raids = obj.events;
						$.mobile.loading( 'hide');
						
						var output = '<ul data-role="listview" data-inset=\'true\'>';
						if (obj.events != null){
							$.each(obj.events, function(key, value) {				
								var statusflag = (value.user_status >= 0) ? '<i class="fa fa-flag status'+value.user_status+'"></i>' : '';
								var raidstatus = ' (';
								icalfeed = value.icalfeed;
								$.each(value.raidstatus, function(key2, value2) {
									if (value2.id){
										raidstatus = raidstatus + '<span class="status'+value2.id+'" title="'+value2.name+'">' + value2.count + '</span> | ';
									}
								});

								if (value.raidstatus.status0){
									raidstatus = raidstatus + '<span class="statusfree" title="free">'+(value.raidstatus.required - value.raidstatus.status0.count) + '</span>)';
								} else {
									raidstatus = raidstatus + '<span class="statusfree" title="free">&infin;</span>)';
								}
								
								var startdate = format_date(value.start);
								
								if (value.closed == 1){
									output = output + "<li><img src='../images/calendar/closed_s.png' alt='closed' /><h3>"+value.title+"</h3><p>"+startdate + raidstatus +"</p></li>";
								} else {
									output = output + "<li><a href='javascript:show_raid("+value.eventid+");'>"+statusflag+"<h3>"+value.title+"</h3><p>"+startdate + raidstatus +"</p></a></li>";
								}
							});
						} else {
							output = '<div class="ui-body ui-body-c ui-corner-all ui-shadow">'+loc['no_raids']+'</div>';
						} 
						output = output + "</ul>";
						//Ical Feed
						if (is_loggedin() && icalfeed){
							output = output + '<br /><a href="'+icalfeed+'" target="_blank"><i class="fa fa-calendar"></i></a> <a href="'+icalfeed+'" target="_blank">'+loc['icalfeed']+'</a>';
						}
						
						
						$('#content_raids').html(output).trigger('create');
					} else {
						//Clear Cron
						window.clearInterval(cron_raids);
						$('#content_raids').html('').trigger('create');
						
						if (obj.error == 'access denied'){
							soft_login();
						}else {
							showMessage(loc['load_error']+' load_raids()');
						}
						
					}
					$.mobile.loading( 'hide');
					loadinginfo_raids = true;
			   },
			   error: function (a,b,c){
					showMessage(loc['load_error']+' load_raids()');
			   }
			 });
	}
	
	function show_raid(id, message){
		$.mobile.changePage('#show_raid');
		var output = "";
		$('#content_show_raid').hide();
		$('#signup_form').hide();
		$('#infos').hide();
		$.mobile.loading( 'show');
		eventid = id;
		
		$.ajax({
			   type: "GET",
			   url: "../api.php?function=calevents_details&eventid="+id+"&format=json&s="+sid,
			   success: function(msg){
					if (message == 'success'){
						showMessage(loc['raidsignup_success'], 'success');
					}
			   
					var obj = msg;
					if (obj.status == '1'){
						
						var title = '<ul data-role="listview" data-inset="true" id="show_raid_title"><li><img src="'+obj.icon+'" style="height:5em;">' + '<h3>'+obj.title+'</h3><p>'+format_date(obj.start)+' - '+format_date(obj.end)+'</p><p>'+obj.note+'</p></li></ul>';
						$('#show_raid_title').html(title).trigger('create');
						//Display Status Information
						$.each(obj.raidstatus, function(key, value){
							if (value.id == '0'){
								$('#raid_status_count_'+value.id).html('<span style="float:left;">'+value.name+'</span><span style="float:right;" class="status'+value.id+'">'+value.count+' '+loc['of']+' '+value.maxcount+'</span>');
							} else {
								$('#raid_status_count_'+value.id).html('<span style="float:left;">'+value.name+'</span><span style="float:right;" class="status'+value.id+'">'+value.count+'</span>');
							}
						});
						
						var intRaidgroups = 0;
						var Raidgroups = new Array();
						$.each(obj.raidgroups, function(key, value){
							if (value.default == 1) {
								intDefaultRaidgroup = value.id;
							}
							Raidgroups[value.id] = value.name;
							intRaidgroups++;
						});
						
						
						//Display Char-Dropdown
						$('#charSelect').html('');
						if (obj.user_chars){
							$('#signup_form').show();
							
							$.each(obj.user_chars, function(key, value){
								var selected = '';
								if (value){
									if (value.main == '1' && obj.user_status.status < 0){
										selected = ' selected="selected"';
									} else {
										if (obj.user_status.status >= 0 && value.id == obj.user_status.char_id){
											selected = ' selected="selected"';
										}
									}
									$('#charSelect').append( '<option value="'+value.id+'" '+selected+'>'+value.name+'</option>' ).trigger('refresh').selectmenu('refresh');
								}
							
							});

							//Role-raid Display Role-Dropdown
							if (obj.categories != 'classes'){
								
								$.each(obj.user_chars, function(key, value){
									roles[value.id] = new Array();
									
									if (value.main == '1' && obj.user_status.status < 0){
										$('#roleSelect').html('');
										$.each(value.roles, function (key2, value2){
											$('#roleSelect').append( '<option value="'+value2.id+'">'+value2.name+'</option>' ).trigger('create').selectmenu('refresh');
										});
									} else {
										if (obj.user_status.status >= 0 && value.id == obj.user_status.char_id){
											$('#roleSelect').html('');
											$.each(value.roles, function (key2, value2){
												$('#roleSelect').append( '<option value="'+value2.id+'">'+value2.name+'</option>' ).trigger('create').selectmenu('refresh');
											});
										}
									}
									
									$.each(value.roles, function (key2, value2){
										roles[value.id][value2.id] = value2.name;
									});
												
								});
								$('#rolerow').show();
							} else {
								$('#rolerow').hide();
							}

							//Display Raidgroup Dropdown
							if (intRaidgroups > 1){
								$('#raidgroup_row').show();
								$('#raidgroupSelect').html('');
								$.each(obj.raidgroups, function(key, value){
									$('#raidgroupSelect').append( '<option value="'+value.id+'">'+value.name+'</option>' ).trigger('create').selectmenu('refresh');
								});
							} else {
								$('#raidgroup_row').hide();
							}
							
							//Display Status-Dropdown
							$('#statusSelect').html('');
							$.each(obj.raidstatus, function(key, value){
								if (value.id != '0'){
									$('#statusSelect').append( '<option value="'+value.id+'">'+value.name+'</option>' ).trigger('create').selectmenu('refresh');
								}
							});
							
							//Display Info if user has signed in
							if (obj.user_status.status >= 0){
								
								var role = (obj.categories != 'classes') ? ', '+loc['role']+': ' + obj.user_status.char_role : '';
								var output = loc['raidstatus']+": <i class=\"status"+obj.user_status.status+" fa fa-flag\"></i> " + obj.user_status.status_name + '<br /> '+loc['char']+': ' + obj.user_status.char_name + role + '</div>';
								if (intRaidgroups > 1){
									myraidgroup = (obj.user_status.raidgroup == 0) ? intDefaultRaidgroup : obj.user_status.raidgroup;
									output = output + '<br />'+loc['raidgroup']+': '+Raidgroups[myraidgroup];
								}
								$('#infos').html(output).show();
							}
							
							
						}
						var comments = '<div data-role="collapsible" data-collapsed="false" data-theme="a"><h3><i class="fa fa-comment"></i> '+loc['comments']+'</h3>';
						
						//Display Comments
						if (obj.comments.count > 0){
							comments = comments + '<ul data-role="listview" data-inset="true">';
							$.each(obj.comments.comments, function(ckey, cvalue) {
								comments = comments + '<div class="comment-container"><div class="comment-avatar"><img src="'+cvalue.user_avatar+'" /></div><div class="comment-message"><h3>' + cvalue.username + ', '+format_date(cvalue.date) + '</h3><p>' + cvalue.message + '</p></div></div>';
							});
							comments = comments + '</ul>';
							
						}			
						if (is_loggedin()){
							comments = comments + '<div><label for="raid_comment" class="loc_comment">'+loc['write_comment']+'</label><textarea id="raid_comment" name="raid_comment"></textarea></div><button name="raid_comment"  data-icon="check" data-theme="b" onclick="add_raid_comment('+id+');" id="raid_comment_button" class="comment_button">'+loc['comment_button']+'</button></div>';
						}
						
						comments = comments + '</div>';
						$('#raid_comments').html(comments).trigger('create').show();
						
						
						$.mobile.loading( 'hide');
						$('#content_show_raid').show();
					} else {
						$('#content_show_raid').hide();
						//Try login
						if (obj.error == 'access denied'){
							soft_login();				
						}else {
							showMessage(loc['load_error']+' show_raid()');
						}
					}
			   },
			   error: function (a,b,c){
					showMessage(loc['load_error']+' show_raid()');
			   }
			 });
		
	}
	
	function changeRoles(){
		var charid = $('#charSelect').val();
		charid = parseInt(charid);
		$('#roleSelect').html('');
		
		$.each(roles[charid], function(key, value){
			if (value != undefined){
				$('#roleSelect').append( '<option value="'+key+'">'+value+'</option>' ).trigger('create').selectmenu('refresh');;	
			}
		});
	}
	
	function raid_signup(){
		$.mobile.loading( 'show');
		
		var memberid = $("#charSelect").val();
		var roleid = $("#roleSelect").val();
		var status = $("#statusSelect").val();
		var note = $("#note").val();
		var raidgroup = $("#raidgroupSelect").val();
		if (raidgroup == undefined){
			raidgroup = intDefaultRaidgroup;
		}
		
		$.ajax({
		   type: "POST",
		   url: "../api.php?function=raid_signup&format=json&s="+sid,
		   data: "<request><eventid>"+eventid+"</eventid><memberid>"+memberid+"</memberid><status>"+status+"</status><role>"+roleid+"</role><note>"+note+"</note><raidgroup>"+raidgroup+"</raidgroup></request>",
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1'){
					//refresh pages
					show_raid(eventid, 'success');
					load_raids();
				} else {
					if (obj.error == 'access denied'){
						soft_login();
					} else {
						showMessage(loc['raidsignup_failed']);
					}
				}
				$('#signup_button').button('enable');
		   },
		   error: function(a, b, c){
				showMessage(loc['load_error']+' raid_signup()');
				$('#signup_button').button('enable');
			}
		 });	
	}
	
	function add_comment(page, attachid, comment, src, id){
		$.ajax({
		   type: "POST",
		   url: "../api.php?function=comment_add&format=json&s="+sid,
		   data: "<request><page>"+page+"</page><attachid>"+attachid+"</attachid><comment>"+comment+"</comment></request>",
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1'){
					//refresh pages
					if (src == 'news'){
						load_news(id);
					}
					
					if (src == 'raid'){
						show_raid(id);
					}
						
				} else {
					if (obj.error == 'access denied'){
						soft_login();
					} else {
						showMessage(loc['comment_failed']);
					}
				}
				$('.comment_button').button('enable');
		   },
		   error: function(a, b, c){
				showMessage(loc['load_error']+' add_comment()');
				$('.comment_button').button('enable');
			}
		 });	
	}
	
	function load_shouts(){					
		$.ajax({
		   type: "GET",
		   url: "../api.php?function=shoutbox_list&format=json&sort=asc&s="+sid,
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1'){
					//Start Cron
					window.clearInterval(cron_shouts);
					cron_shouts = window.setInterval(load_shouts, 1000 * 60 * 3); //3 Min
					var output = '<div class="shouts">';
					$.each(obj.entries, function(key, value){
						output = output + '<div class="comment-container"><div class="comment-avatar"><img src="'+value.user_avatar+'" /></div><div class="comment-message"><h3>' + value.name + ', '+format_date(value.date) + '</h3><p>' + value.text + '</p></div></div>';
					});
					output = output + '</div>';
					$('#shouts').html(output).trigger('create');				
					if (!is_loggedin()){
						$('#shoutform').hide();
					} else {
						$('#shoutform').show();
					}
					$('#content_shouts').show();
					
				} else {
					//Clear Cron
					window.clearInterval(cron_shouts);
					$('#content_shouts').hide();
					//Try login
					if (obj.error == 'access denied'){
						soft_login();
					}else {
						showMessage(loc['shouts_loading_error'], 'info');
					}
				}
				$.mobile.loading( 'hide');
				loadinginfo_shouts = true;
		   },
		   error: function (a,b,c){
				showMessage(loc['load_error']+' load_shouts()');
		   }
		 });
	}
	
	function shout(){
		var note = $("#shouttext").val();
		if (note == '') {
			return false;
		}
		$("#shoutButton").button().button('disable');
		$.mobile.loading( 'show');
		$.ajax({
		   type: "POST",
		   url: "../api.php?function=shoutbox_add&format=json&s="+sid,
		   data: "<request><text>"+note+"</text></request>",
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1'){
					load_shouts();
					$("#shouttext").val('');
				} else {
					if (obj.error == 'access denied'){
						soft_login();
					}else {
						showMessage(loc['shout_failed']);
					}	
				}
				$.mobile.loading( 'hide');
				$("#shoutButton").button('enable');
		   },
		   error: function(a, b, c){
				showMessage(loc['load_error']+' shout()');
				$("#shoutButton").button('enable');
			}
		 });	
	}
	
	function load_points(){					
		$.ajax({
		   type: "GET",
		   url: "../api.php?function=points&format=json&include_html=true&s="+sid,
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1'){
					//Start Cron
					window.clearInterval(cron_points);
					cron_points = window.setInterval(load_points, 1000 * 60 * 10); //10 Min
					
					//MultiDKP-Pools
					var mdkp_select = '<select id="mdkp_select" onchange="switch_points();" data-native-menu="false">';
					var mdkp_id = 0;
					$.each(obj.multidkp_pools, function(key, value){
						if (mdkp_id == 0){
							mdkp_id = value.id;
						}
						mdkp_select = mdkp_select + '<option value="'+value.id+'">'+value.name+'</option>';
					});
					mdkp_select = mdkp_select + '</select><br />';
					
					var output = mdkp_select + '<div id="points_list"><ul data-role="listview" data-inset="true" data-filter="true">';
					
					$.each(obj.players, function(key, value){
						if (value.active == 0) {
							return true;
						}
						output = output + "<li><h3>"+value.name+"</h3>";
						points[value.id] = new Array();
						$.each(value.points, function(pkey, pvalue){
							if (obj.info.with_twink){
								points[value.id][pvalue.multidkp_id] = pvalue.points_current_with_twink_html;
							} else {
								points[value.id][pvalue.multidkp_id] = pvalue.points_current_html;
							}
						});
						
						output = output + '<h3 class="ui-li-aside" id="member_points_'+value.id+'">' + points[value.id][mdkp_id] + '</h3><p>'+value.class_name+'</p></li>';
					});
					output = output + '</ul></div>';
					$('#content_points').html(output).trigger('create');				
					$('#content_points').show();
					
				} else {
					//Clear Cron
					window.clearInterval(cron_points);
					$('#content_points').hide();
					//Try login
					if (obj.error == 'access denied'){
						soft_login();
					}else {
						showMessage(loc['points_loading_error'], 'info');
					}
				}
				$.mobile.loading( 'hide');
				loadinginfo_points = true;
		   },
		   error: function (a,b,c){
				showMessage(loc['load_error']+' load_points()');
		   }
		 });
	}
	
	function switch_points(){
		var mdkp_id = $("#mdkp_select").val();
		$.each(points, function(key, value){
			if (value != undefined){
				$('#member_points_'+key).html(value[mdkp_id]);
			}
		});
	}
	
	
	function load_forum(){
		$.ajax({
			   type: "GET",
			   url: "../api.php?function=latestposts&format=json&s="+sid,
			   success: function(msg){					
					var obj = msg;
					if (obj.status == '1'){
						//Start Cron
						window.clearInterval(cron_forum);
						cron_news = window.setInterval(load_forum, 1000 * 60 * 10); //10 Min	
					
						var output = '<ul data-role="listview" data-inset=\'true\'>';
						if (obj.posts != null){
							$.each(obj.posts, function(key, value) {
								output = output + '<li><a href="'+value.topic_link+'" rel="external"><h3>'+value.topic_title+'</h3><p>'+format_date(value.topic_lastpost_date)+', '+value.topic_lastpost_username+"</p><span class='ui-li-count'>"+value.topic_replies+" <i class='fa fa-comments'></i></span></a></li>";
							});
						} else {
							output = '<li>'+loc['no_posts']+'</li>';
						}
						output = output + "</ul>";
						if (obj.forum_url != ""){
							output = output + '<a href="'+obj.forum_url+'" data-role="button" rel="external" data-theme="e">'+loc['gotoforum']+'</a>'
						}
						$('#content_forum').html(output).trigger('create');
					} else {
						//Clear Cron
						window.clearInterval(cron_forum);
						$('#content_forum').html('').trigger('create');
						if (obj.error == 'access denied'){
							soft_login();				
						} else {
							if (obj.error == 'function not found'){
								if (common_infos && common_infos.eqdkp.forum_url != ""){
									$('#content_forum').html('<a href="'+common_infos.eqdkp.forum_url+'" data-role="button" rel="external" data-theme="b">'+loc['gotoforum']+'</a>').trigger('create');
								} else {
									showMessage(loc['posts_loading_error'], 'info');
								}
							} else {		
								showMessage(loc['load_error']+' load_forum()');
							}
						}
						
					}
					$.mobile.loading( 'hide');
					loadinginfo_forum = true;
			   },
			   error: function (a,b,c){
					showMessage(loc['load_error']+' load_forum()');
			   }
			 });
	}
	
	function dologin(){
		var password = $('#eqdkp_password').val();
		var username = $('#eqdkp_username').val();
		var remember = ($('#eqdkp_remember').attr('checked') == 'checked');
		if (password != "" && username != ""){
			$.ajax({
				   type: "POST",
				   url: "../api.php?function=get_salt&format=json",
				   data: "<request><user>"+ username +"</user></request>",
				   success: function(msg){
						var obj = msg;
						
						if (obj.status == '1' && obj.salt != ""){
							salt = $.base64Decode(obj.salt);
							if (salt != ""){
								var hash = hex_sha512(salt+password);
								
								//Now try an login
								login(username, hash, remember);
							}
							
						} else {
							showMessage(loc['login_failed'], 'error', true);
						}
						
				   },
				   error: function(a, b, c){
					showMessage(loc['load_error']+' dologin()');
				   }
			});
		} else {
			showMessage(loc['missing_credentials']);
			return false;
		}
		
		$.mobile.changePage('#main');
		loadinginfo_news = false;
	}
	
	function login(username, hash, remember){
	
		$.ajax({
		   type: "POST",
		   url: "../api.php?function=login&format=json",
		   data: "<request><user>"+ username +"</user><password>"+hash+"</password></request>",
		   success: function(msg){
				var obj = msg;
				if (obj.status == '1' && obj.sid != ''){
					sid = obj.sid;
					if (remember){
						var rem_data = $.base64Encode(hash + '||' + username);
						SetCookie('eqdkpm_data', rem_data, 365);
					}
					SetCookie('eqdkpm_sid', sid, 365);
					$('#eqdkp_password').val('');
					//refresh pages
					refresh();
					load_news();
					//show logout button
					$('.eq-not-loggedin').hide();
					$('.eq-loggedin').show();
				} else {
					showMessage(loc['login_failed'], 'error', true);
				}
		   },
		   error: function(a, b, c){
				showMessage(loc['load_error']+' login()');
			}
		 });

	}
	
	function soft_login(){
		showMessage(loc['nopermissions'], 'info');
		var data = ReadCookie('eqdkpm_data');
		if (data != ""){
			data = $.base64Decode(data);
			var arrData = data.split('||');
			var username = arrData[1];
			var hash = arrData[0];
			
			if (username != "" && hash != ""){
				login(username, hash, true);
			}
		} else {
			showMessage(loc['loginneeded'], 'info', true);
		}
	}
	
	function is_loggedin(){
		var data = ReadCookie('eqdkpm_data');
		if (data != ""){
			$('.eq-not-loggedin').hide();
			$('.eq-loggedin').show();
			return true;
		} else {
			$('.eq-not-loggedin').show();
			$('.eq-loggedin').hide();
			return false;
		}
	}
	
	function logout(){
		//Send logout-request
		$.ajax({
		   type: "POST",
		   url: "../api.php?function=logout&format=json",
		   data: "<request><sid>"+ sid +"</sid></request>",
		   success: function(msg){
			refresh();
		   },
		   error: function(a, b, c){
				refresh();
			}
		 });
		//Delete Cookies
		SetCookie('eqdkpm_sid', '', -1);
		SetCookie('eqdkpm_data', '', -1);
		//Show login button
		$('.eq-not-loggedin').show();
		$('.eq-loggedin').hide();
	}
	
	function refresh(){
		hideMessage();
		refresh_news = true;
		refresh_shouts = true;
		refresh_raids = true;
		refresh_points = true;
		refresh_forum = true;
		loadinginfo_news = false;
		loadinginfo_shouts = false;
		loadinginfo_raids = false;
		loadinginfo_points = false;
		loadinginfo_forum = false;
	}
	
	function SetCookie(cookieName,cookieValue,nDays) {
		 var today = new Date();
		 var expire = new Date();
		 if (nDays==null || nDays==0) nDays=1;
		 expire.setTime(today.getTime() + 3600000*24*nDays);
		 document.cookie = cookieName+"="+escape(cookieValue)
						 + ";expires="+expire.toGMTString();
	}
	
	function ReadCookie(cookieName) {
		 var theCookie=" "+document.cookie;
		 var ind=theCookie.indexOf(" "+cookieName+"=");
		 if (ind==-1) ind=theCookie.indexOf(";"+cookieName+"=");
		 if (ind==-1 || cookieName=="") return "";
		 var ind1=theCookie.indexOf(";",ind+1);
		 if (ind1==-1) ind1=theCookie.length; 
		 return unescape(theCookie.substring(ind+cookieName.length+2,ind1));
	}
	
	function showMessage(message, type, showLogin){
		$.mobile.loading( 'hide');
		
		if (type == null){
			type = 'error';
		}
		var output = '';
		if (type == 'error'){
			output = '<div class="error ui-body ui-body-e ui-corner-all ui-shadow">' + message + '</div>';
		};
		if (type == 'success'){
			output = '<div class="ok ui-body ui-body-e ui-corner-all ui-shadow">' + message + '</div>';
		};
		if (type == 'info'){
			output = '<div class="info ui-body ui-body-e ui-corner-all ui-shadow">' + message + '</div>';
		};
		
		if (showLogin){
			output = output + '<br /><a href="#eq-login-panel" data-role="button" data-rel="dialog" data-transition="pop" data-icon="lock">'+loc['login']+'</a>';
		}
		
		$('.message').html(output).show().trigger('create');	
	}
	
	function hideMessage(){
		$('.message').hide();
	}
	
	function format_date(value){
		var date = value.split(" ");
		var formatted = $.datepicker.formatDate(loc['dateformat'], $.datepicker.parseDate('yy-mm-dd', date[0]), {dayNamesShort: loc['daynamesshort']});
		return formatted + ', ' + date[1];
	
	}
	function detect_browser_lang(){
		 var l_lang;
		  if (navigator.userLanguage) // Explorer
			l_lang = navigator.userLanguage;
		  else if (navigator.language) // FF
			l_lang = navigator.language;
		  else
			l_lang = "en-EN";
		return l_lang;
	}
	

</script>

<!-- NEWS = MAIN PAGE
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="main">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_news">Home</span></h1>
			<div class="message">
			</div>
			<div id="content_news">
			</div>
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li class="active"><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			
			</li>
			<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>

	</div><!-- /content -->
	
	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->

<!-- SHOW NEWS
===========================================================================
-->
<div data-role="page" class="eq-demos eq-home" id="show_news">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->
	
	<div role="main" class="ui-content">
		<div class="eq-content">
		
			<h1><span class="loc_news">Show News</span></h1>
			<div class="message">
			</div>
	
			<div id="content_show_news">
			</div>
		
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li class="active"><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>		
			</li>
			<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>

	</div><!-- /content -->
	
	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->

<!-- SHOUTBOX
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="shout">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_shouts">Shoutbox</span></h1>	
			
			<div class="message">
			</div>
			<div id="content_shouts" style="display:none;">
				<div id="shouts"></div>
				<div id="shoutform">
					<textarea id="shouttext"></textarea>
					<button onclick="shout();" id="shoutButton" data-icon="check" data-theme="b">Shout!</button>	
				</div>
			</div>
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li class="active"><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			
			</li>
			<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>
	</div><!-- /content -->
	
	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->



<!-- RAIDS
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="raids">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_raids">Raids</span></h1>	
			<div class="message">
			</div>
			<div id="content_raids">
			</div>	
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			
			</li>
			<li class="active"><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>
	</div><!-- /content -->
	
	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->

<!-- SHOW RAID
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="show_raid">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_raids">Raids</span></h1>	
			<div class="message">
			</div>
	
			<div id="content_show_raid" style="display:none;">
				<div id="show_raid_title"></div>
			
			<div class="ui-body-a ui-body ui-corner-all ui-shadow" id="infos" style="display:none;">
			</div>
			<br />
			<ul data-role="listview"  data-inset="true">
				<li><div class="ui-bar ui-bar-c" id="raid_status_count_0"></div></li>
				<li><div class="ui-bar ui-bar-c" id="raid_status_count_1"></div></li>
				<li><div class="ui-bar ui-bar-c" id="raid_status_count_2"></div></li>
				<li><div class="ui-bar ui-bar-c" id="raid_status_count_3"></div></li>
			</ul>
			
			<br />
			<div class="ui-body ui-body-a ui-corner-all ui-shadow" id="signup_form" style="display:none;">
				<h3 class="loc_raid_signup">Signup for this Raid</h3>
				<div data-role="fieldcontain">
					<label for="charSelect" class="loc_select_char">Select Char:</label>
					<select id="charSelect" onchange="changeRoles();" name="charSelect" data-native-menu="false"></select>
				</div>
				<div data-role="fieldcontain" id="rolerow">
					<label for="roleSelect" class="loc_select_role">Select Role:</label>
					<select id="roleSelect" data-native-menu="false" name="roleSelect"></select>
				</div>
				<div data-role="fieldcontain">
					<label for="statusSelect" class="loc_select_status">Select Status</label>
					<select id="statusSelect" name="statusSelect" data-native-menu="false"></select>
				</div>
				<div data-role="fieldcontain" id="raidgroup_row">
					<label for="raidgroupSelect" class="loc_raidgroup">Select Raidgroup</label>
					<select id="raidgroupSelect" name="raidgroupSelect" data-native-menu="false"></select>
				</div>
				<div data-role="fieldcontain">
					<label for="note" class="loc_note">Note</label>
					<input type="text" id="note" name="note" />
				</div>
				<button name="signup" onclick="raid_signup();" data-theme="b" id="signup_button">Signup</button>
			</div>
			
			<br />
			<div id="raid_comments"></div>
			
			</div>
		
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			</li>
			<li  class="active"><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>
	</div><!-- /content -->

	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->


<!-- FORUM
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="forum">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_forum">Forum</span></h1>
			
			<div class="message">
			</div>
			<div id="content_forum">
			</div>
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			
			</li>
			<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li  class="active"><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>

	</div><!-- /content -->
	
	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->




<!-- POINTS
===========================================================================
-->

<div data-role="page" class="eq-demos eq-home" id="points">

	<div data-role="header" class="eq-header-container">
		<div class="eq-header">
			<h2><img src="../templates/maintenance/images/logo.svg" alt="EQdkp Plus"></h2>
			<p><span class="guildname">The Gamer CMS &amp; DKP System</span></p>
			<a href="#eq-navmenu-panel" class="eq-hide-tablet ui-btn ui-btn-icon-notext ui-corner-all ui-icon-bars ui-nodisc-icon ui-alt-icon ui-btn-left">Menu</a>
			<a href="#eq-login-panel" class="eq-login-link ui-btn ui-btn-icon-notext ui-corner-all ui-icon-lock ui-nodisc-icon ui-alt-icon ui-btn-right">Login</a>
		</div>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<div class="eq-content">
			<h1><span class="loc_points">Points</span></h1>
			<div class="message">
			</div>
			<div id="content_points"></div>
		</div>
		<ul class="eq-sidenav-tablet" data-role="listview">
			<li><a href="#main"><span class="loc_news">Home</span>
			
			<span class="fa-stack">
			  <i class="fa fa-circle fa-stack-2x"></i>
			  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
			</span>
			
			</a></li>
			<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
					</span>
			</a>
			
			</li>
			<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
					<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
			
				<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
					</span>
			</a></li>
			<li  class="active"><a href="#points" class="a_points"><span class="loc_points">Points</span>
			<span class="fa-stack">
					  <i class="fa fa-circle fa-stack-2x"></i>
					  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
					</span></a></li>
		</ul>

	</div><!-- /content -->

	<div data-role="footer" data-position="fixed" data-tap-toggle="false" class="eq-footer">
		<p><a href="../" rel="external" class="loc_fulllink" data-ajax="false">Back to full version</a></p>
		<p><a href="http://eqdkp-plus.eu/about" data-ajax="false">Copyright 2014 EQdkp Plus Team</a></p>
	</div><!-- /footer -->

</div><!-- /page -->


<!-- LOGIN PANEL
===========================================================================
-->
<div data-role="panel" class="eq-login-panel" data-position="right" data-display="overlay" data-theme="a" id="eq-login-panel">
	<h1 class="loc_login">Login</h1>
			
	<div data-role="content">
		<div class="message"></div>
		<form action="#main" method="post" id="form_login" onsubmit="dologin(); return false;" data-ajax="false" class="eq-not-loggedin">
			<div class="ui-field-contain">
				<label for="eqdkp_username" class="loc_username">Username:</label><br />
				<input type="text" name="eqdkp_username" id="eqdkp_username" value=""  />
			</div>
			<div class="ui-field-contain">
				<label for="eqdkp_password" class="loc_password">Password:</label><br />
				<input type="password" name="eqdkp_password" id="eqdkp_password" value="" />
			</div>
			<div class="ui-field-contain">
				<label for="eqdkp_remember" class="loc_remember">Remember me</label>
				<input type="checkbox" name="eqdkp_remember" id="eqdkp_remember" value="" checked="checked" />
			</div>
			<button type="submit" name="login" id="login_submit" data-icon="check" data-theme="b" class="loc_login">Login</button>
		</form>
		
		<div class="eq-loggedin">
			<span class="loc_uareloggedin"></span>
			<button onclick="javascript:logout();" id="logout_button" data-theme="b">Logout</button>
		</div>
	</div><!-- /content -->
	</div><!-- /panel -->
	
<!-- NAVIGATION PANEL
===========================================================================
-->

	<div data-role="panel" class="eq-navmenu-panel eq-navmenu-panel-page" data-position="left" data-display="reveal" data-theme="a" id="eq-navmenu-panel">
		<div data-role="content">
			<ul class="eq-panelnav" data-role="listview">
				<li><a href="#main"><span class="loc_news">Home</span>
				
				<span class="fa-stack">
				  <i class="fa fa-circle fa-stack-2x"></i>
				  <i class="fa fa-home fa-stack-1x fa-inverse"></i>
				</span>
				
				</a></li>
				<li><a href="#shout" class="a_shout"><span class="loc_shouts">Shoutbox</span>
						<span class="fa-stack">
						  <i class="fa fa-circle fa-stack-2x"></i>
						  <i class="fa fa-bullhorn fa-stack-1x fa-inverse"></i>
						</span>
				</a>				
				</li>
				<li><a href="#raids" class="a_raids"><span class="loc_raids">Raids</span>
						<span class="fa-stack">
						  <i class="fa fa-circle fa-stack-2x"></i>
						  <i class="fa fa-calendar fa-stack-1x fa-inverse"></i>
						</span>
				</a></li>
				<li><a href="#forum" class="a_forum"><span class="loc_forum">Forum</span>
				
					<span class="fa-stack">
						  <i class="fa fa-circle fa-stack-2x"></i>
						  <i class="fa fa-comments fa-stack-1x fa-inverse"></i>
						</span>
				</a></li>
				<li><a href="#points" class="a_points"><span class="loc_points">Points</span>
				<span class="fa-stack">
						  <i class="fa fa-circle fa-stack-2x"></i>
						  <i class="fa fa-list fa-stack-1x fa-inverse"></i>
						</span></a></li>
			</ul>
		</div><!-- /content -->
	
	</div><!-- /panel -->
</body>
</html>
